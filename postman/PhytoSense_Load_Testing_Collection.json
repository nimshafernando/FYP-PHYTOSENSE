{
  "info": {
    "name": "PhytoSense Load Testing Collection",
    "description": "Comprehensive load testing for PhytoSense Medicinal Leaf Classifier API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Homepage Load Test",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
          },
          {
            "key": "User-Agent",
            "value": "PhytoSense-LoadTest/1.0"
          }
        ],
        "url": {
          "raw": "{{base_url}}/",
          "host": ["{{base_url}}"],
          "path": [""]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Homepage loads successfully', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response time is acceptable', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(5000);",
              "});",
              "",
              "pm.test('Content-Type is HTML', function () {",
              "    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/html');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "QSAR Prediction Load Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"smiles\": \"{{test_smiles}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/predict_qsar",
          "host": ["{{base_url}}"],
          "path": ["predict_qsar"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('QSAR prediction successful', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response time under 5 seconds', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(5000);",
              "});",
              "",
              "pm.test('Response contains prediction data', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('prediction');",
              "});",
              "",
              "pm.test('Prediction is array', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.prediction).to.be.an('array');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Molecular Descriptors Load Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"smiles\": \"{{test_smiles}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/calculate_descriptors",
          "host": ["{{base_url}}"],
          "path": ["calculate_descriptors"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Descriptors calculated successfully', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response time acceptable for descriptors', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(5000);",
              "});",
              "",
              "pm.test('Response contains descriptors', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('descriptors');",
              "});",
              "",
              "pm.test('Descriptors count is valid', function () {",
              "    const jsonData = pm.response.json();",
              "    const descriptorCount = Object.keys(jsonData.descriptors).length;",
              "    pm.expect(descriptorCount).to.be.above(100);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "3D Structure Conversion Load Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"compound_name\": \"{{test_compound_name}}\",\n  \"smiles\": \"{{test_smiles}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/convert_smiles_to_3d",
          "host": ["{{base_url}}"],
          "path": ["api", "convert_smiles_to_3d"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('3D conversion successful', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response time under 5 seconds', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(5000);",
              "});",
              "",
              "pm.test('3D structure generated', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('mol_block_3d');",
              "});",
              "",
              "pm.test('3D structure is not empty', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.mol_block_3d.length).to.be.above(100);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "AutoDock Vina Load Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"compound_name\": \"{{test_compound_name}}\",\n  \"smiles\": \"{{test_smiles}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/autodock_vina",
          "host": ["{{base_url}}"],
          "path": ["api", "autodock_vina"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('AutoDock Vina docking successful', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response time under 10 seconds', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(10000);",
              "});",
              "",
              "pm.test('Docking poses generated', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('poses');",
              "});",
              "",
              "pm.test('At least one docking pose', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.poses.length).to.be.above(0);",
              "});",
              "",
              "pm.test('Best pose has binding affinity', function () {",
              "    const jsonData = pm.response.json();",
              "    if (jsonData.poses.length > 0) {",
              "        pm.expect(jsonData.poses[0]).to.have.property('binding_affinity');",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Reference IC50 Data Test",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/reference_ic50",
          "host": ["{{base_url}}"],
          "path": ["api", "reference_ic50"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Reference IC50 data accessible', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response time is fast', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(1000);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Complex Molecule - Quercetin Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"smiles\": \"C1=CC(=C(C=C1C2=C(C(=O)C3=C(C=C(C=C3O2)O)O)O)O)O\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/predict_qsar",
          "host": ["{{base_url}}"],
          "path": ["predict_qsar"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Complex molecule prediction successful', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Complex molecule response time acceptable', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(8000);",
              "});",
              "",
              "pm.test('Prediction data structure valid', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('prediction');",
              "    pm.expect(jsonData).to.have.property('targets');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Stress Test - Multiple Compounds",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"compounds\": [\n    {\n      \"name\": \"Quercetin\",\n      \"smiles\": \"C1=CC(=C(C=C1C2=C(C(=O)C3=C(C=C(C=C3O2)O)O)O)O)O\"\n    },\n    {\n      \"name\": \"Luteolin\",\n      \"smiles\": \"C1=CC(=C(C=C1C2=C(C(=O)C3=C(C=C(C=C3O2)O)O)O)O)O\"\n    },\n    {\n      \"name\": \"Apigenin\",\n      \"smiles\": \"C1=CC(=CC=C1C2=CC(=O)C3=C(C=C(C=C3O2)O)O)O\"\n    }\n  ]\n}"
        },
        "url": {
          "raw": "{{base_url}}/predict_batch_qsar",
          "host": ["{{base_url}}"],
          "path": ["predict_batch_qsar"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Batch prediction handles multiple compounds', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Batch processing time reasonable', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(15000);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "exec": [
          "// Set random SMILES for testing variety",
          "const testSmiles = [",
          "    'CCO',",
          "    'CC(=O)OC1=CC=CC=C1C(=O)O',",
          "    'C1=CC(=C(C=C1C2=C(C(=O)C3=C(C=C(C=C3O2)O)O)O)O)O',",
          "    'C1=CC(=C(C=C1C2=C(C(=O)C3=C(C=C(C=C3O2)O)O)O)O)O',",
          "    'C1=CC(=CC=C1C2=CC(=O)C3=C(C=C(C=C3O2)O)O)O'",
          "];",
          "",
          "const compoundNames = [",
          "    'Ethanol',",
          "    'Aspirin',",
          "    'Quercetin',",
          "    'Luteolin',",
          "    'Apigenin'",
          "];",
          "",
          "const randomIndex = Math.floor(Math.random() * testSmiles.length);",
          "pm.environment.set('test_smiles', testSmiles[randomIndex]);",
          "pm.environment.set('test_compound_name', compoundNames[randomIndex]);"
        ],
        "type": "text/javascript"
      }
    },
    {
      "listen": "test",
      "script": {
        "exec": [
          "// Global test for all requests",
          "pm.test('No server errors (5xx)', function () {",
          "    pm.expect(pm.response.code).to.be.below(500);",
          "});",
          "",
          "pm.test('Response time recorded', function () {",
          "    pm.expect(pm.response.responseTime).to.exist;",
          "});",
          "",
          "// Store performance metrics",
          "const responseTime = pm.response.responseTime;",
          "const statusCode = pm.response.code;",
          "const requestName = pm.info.requestName;",
          "",
          "if (!pm.globals.get('performance_metrics')) {",
          "    pm.globals.set('performance_metrics', JSON.stringify([]));",
          "}",
          "",
          "const metrics = JSON.parse(pm.globals.get('performance_metrics'));",
          "metrics.push({",
          "    request: requestName,",
          "    responseTime: responseTime,",
          "    statusCode: statusCode,",
          "    timestamp: new Date().toISOString()",
          "});",
          "",
          "pm.globals.set('performance_metrics', JSON.stringify(metrics));"
        ],
        "type": "text/javascript"
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "test_smiles",
      "value": "CCO",
      "type": "string"
    },
    {
      "key": "test_compound_name",
      "value": "Ethanol",
      "type": "string"
    }
  ]
}